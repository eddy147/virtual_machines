# NixOS VM

This repository contains a [NixOS](https://nixos.org/) [VM](https://nixos.wiki/wiki/NixOS_on_VirtualBox) for development and testing.

## Launch the VM 

```bash
export QEMU_KERNEL_PARAMS="console=ttyS0"
export QEMU_NET_OPTS="hostfwd=tcp:127.0.0.1:2222-:22,hostfwd=tcp:127.0.0.1:24680-:80"
./result/bin/run-nixos-vm -nographic; reset
```

Hence the launch.sh script.

## SSH into the machine

```bash
ssh -p 2222 root@127.0.0.1 hostname
```

## Web server

```bash
curl -D - http://localhost:24680
```

## Stopping Virtual Machine

If you are logged in to the root account, you can issue poweroff command to stop the virtual machine.

Alternatively, you can kill the qemu process.

Finally, if you want to remove the state persisted by the virtual machine, you can delete the nixos.qcow2 file generated by the run-nixos-vm script.
